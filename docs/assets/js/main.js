"use strict";let input=document.querySelector(".js-input");const searchButton=document.querySelector(".js-searchButton");let searchResultList=document.querySelector(".searchresults");const favouriteSelector=document.querySelectorAll(".results"),favouriteListOfAnimes=document.querySelector(".searchresults__favourites"),alternativeImage="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";let userInput="",animeSeriesArray=[],favouriteSeriesArray=[];function fetchDataAnime(){searchResultList.innerHTML="",fetch("https://api.jikan.moe/v3/search/anime?q="+input.value).then(e=>e.json()).then(e=>{if(animeSeriesArray=e.results,0===animeSeriesArray.length)searchResultList.innerHTML+='<p class="paragraph">No existe este t√≠tulo. Prueba con otro</p>';else for(let e=0;e<animeSeriesArray.length;e++){const t=animeSeriesArray[e];null===t.img_url?searchResultList.innerHTML+=`<article class="results" data-id="${t.mal_id}"> <p><h3 data-title="${t.title}class="searchresults__title--js" >${t.title}</h3></p><img class="image" src="${alternativeImage}"/></article>`:searchResultList.innerHTML+=`<article class="results" data-id="${t.mal_id}"> <p><h3 data-title="${t.title}" class= "searchresults__title--js">${t.title}</h3></p><img class="image" src="${t.image_url}"/></article>`;const r=document.querySelectorAll(".results");for(const e of r)e.addEventListener("click",globalFunction)}})}function changeColorFavourite(e){e.currentTarget.classList.toggle("favourite")}function handleFavourites(e){const t=parseInt(e.currentTarget.dataset.id);let r=favouriteSeriesArray.findIndex(e=>e.mal_id===t);if(r>=0)favouriteSeriesArray.splice(r,1);else{const e=animeSeriesArray.find(e=>e.mal_id===t);favouriteSeriesArray.push(e)}console.log(favouriteSeriesArray),localStorage.setItem("favourites",JSON.stringify(favouriteSeriesArray))}function renderFavourites(){favouriteListOfAnimes.innerHTML="";for(let e=0;e<favouriteSeriesArray.length;e++)favouriteListOfAnimes.innerHTML+=`<article class="results" > <p><h3 class= "searchresults__title">${favouriteSeriesArray[e].title}</h3></p><img class="image" src="${favouriteSeriesArray[e].image_url}"/></article>`}function deleteFavourites(){for(let e=0;e<favouriteSeriesArray;e++)favouriteSeriesArray[e].contains("favourite")&&favouriteSeriesArray[e].classList.remove("favourite")}function getStorageData(){const e=JSON.parse(localStorage.getItem("favourites"));null!==e&&(favouriteSeriesArray=e),renderFavourites()}function globalFunction(e){handleFavourites(e),changeColorFavourite(e),renderFavourites(),deleteFavourites()}searchButton.addEventListener("click",fetchDataAnime),getStorageData();